# Guild Distro Sorting Script
# Sorts items from 0x4F9D4339 based upon item type into 4 Distro Chests, an Extras Chest, and Gold Chest
# script by TheZeroDivide
# script edited by LyzaLii
# last update:  6/8/2025 - Update: Adjusted Amounts moved for Extras and Gold to bulk rather than 1 at a time, added Food Stuffs to Extras

# Set variables if they dont exist
if not varexist distro_1
    @setvar! distro_1 
endif
if not varexist distro_2
    @setvar! distro_2
endif
if not varexist distro_3
    @setvar! distro_3
endif
if not varexist distro_4
    @setvar! distro_4
endif
if not varexist Extra
    @setvar! Extra
endif
if not varexist Gold
    @setvar! Gold
endif

# Check if chests are full
overhead "Checking Chests"
getlabel distro_1 desc
    if "125 items" in desc
        overhead "First chest is full! Stopping Script!"
        stop
    endif
getlabel distro_2 desc
    if "125 items" in desc
        overhead "Second chest is full! Stopping Script!"
        stop
    endif
getlabel distro_3 desc
    if "125 items" in desc
        overhead "Third chest is full! Stopping Script!"
        stop
    endif
getlabel distro_4 desc
    if "125 items" in desc
        overhead "Fourth chest is full! Stopping Script!"
        stop
    endif
getlabel Extra desc
    if "125 items" in desc
        overhead "Extra chest is full! Stopping Script!"
        stop
    endif
getlabel Gold desc
    if "125 items" in desc
        overhead "Gold chest is full! Stopping Script!"
        stop
    endif

overhead "Starting Item Sort!" 65
clearignore

#Create lists to sort cores into
removelist coreHues_Distro_3
createlist coreHues_Distro_3
removelist coreHues_Distro_4
createlist coreHues_Distro_4


# Add Cores that should go in distro_3

pushlist coreHues_Distro_3 2263 #Air
pushlist coreHues_Distro_3 2155 #Death
pushlist coreHues_Distro_3 2490 #Discipline
pushlist coreHues_Distro_3 2767 #Earth
pushlist coreHues_Distro_3 2618 #Eldritch
pushlist coreHues_Distro_3 2635 #Fire
pushlist coreHues_Distro_3 2669 #Gadget
pushlist coreHues_Distro_3 2153 #Holy
pushlist coreHues_Distro_3 2241 #Lyric
pushlist coreHues_Distro_3 1060 #Madness
pushlist coreHues_Distro_3 2592 #Water
pushlist coreHues_Distro_3 2503 #War

# Add Cores that should go in distro_4

pushlist coreHues_Distro_4 1560 #Arcane
pushlist coreHues_Distro_4 2096 #Artisan
pushlist coreHues_Distro_4 2087 #Blood
pushlist coreHues_Distro_4 1428 #Command
pushlist coreHues_Distro_4 2843 #Fortune
pushlist coreHues_Distro_4 2234 #Frost
pushlist coreHues_Distro_4 2208 #Harvest
pushlist coreHues_Distro_4 2650 #Lightning
pushlist coreHues_Distro_4 2897 #Poison
pushlist coreHues_Distro_4 1757 #Shadow
pushlist coreHues_Distro_4 1790 #Shadow
pushlist coreHues_Distro_4 2582 #Void


# Set Map Keywords that should do in distro_4
removelist distro_4_keywords
createlist distro_4_keywords
pushlist distro_4_keywords "drawn"
pushlist distro_4_keywords "skinning"
pushlist distro_4_keywords "ore"
pushlist distro_4_keywords "lumber"

#Set Map Keywords that should go in distro_3
removelist distro_3_keywords
createlist distro_3_keywords
pushlist distro_3_keywords "1"
pushlist distro_3_keywords "2"
pushlist distro_3_keywords "dull"
pushlist distro_3_keywords "shadow"
pushlist distro_3_keywords "copper"
pushlist distro_3_keywords "bronze"
pushlist distro_3_keywords "gold"
pushlist distro_3_keywords "fish"

#Set Hues of Dye, Cloth, or Clothing that should go to distro_2
removelist Hues_Distro_2
createlist Hues_Distro_2
pushlist Hues_Distro_2 1779 #Aegis
pushlist Hues_Distro_2 1909 #Inferno
pushlist Hues_Distro_2 2091 #Ossuary
pushlist Hues_Distro_2 2099 #DarkmireTemple
pushlist Hues_Distro_2 2085 #Pulma
pushlist Hues_Distro_2 2092 #TheMausoleum
pushlist Hues_Distro_2 2089 #MountPetram
pushlist Hues_Distro_2 2796 #Nusero
pushlist Hues_Distro_2 2338 #Cavernam
pushlist Hues_Distro_2 2093 #ShadowspireCathedral
pushlist Hues_Distro_2 2659 #Time
pushlist Hues_Distro_2 2841 #KraulHive
pushlist Hues_Distro_2 1182 #Wilderness
pushlist Hues_Distro_2 1183 #Ocean
pushlist Hues_Distro_2 1500 #Netherzone

#Set Hues of Dye, Cloth, or Clothing that should go to distro_3
removelist Hues_Distro_3
createlist Hues_Distro_3
pushlist Hues_Distro_3 1467 #DarkCoffee
pushlist Hues_Distro_3 2807 #DarkRust
pushlist Hues_Distro_3 1939 #DarkCrimson
pushlist Hues_Distro_3 1465 #DarkBlood
pushlist Hues_Distro_3 2174 #DarkSalmon
pushlist Hues_Distro_3 2804 #DarkForest
pushlist Hues_Distro_3 2226 #DarkPeacock
pushlist Hues_Distro_3 2801 #DarkDenim
pushlist Hues_Distro_3 1156 #DarkBerry

#Set Hues of Dye, Cloth, or Clothing that should go to distro_4
removelist Hues_Distro_4
createlist Hues_Distro_4
pushlist Hues_Distro_4 4124 #LustrousLavender
pushlist Hues_Distro_4 4125 #LustrousCarmine
pushlist Hues_Distro_4 4126 #LustrousSeagrass
pushlist Hues_Distro_4 4127 #LustrousGrass
pushlist Hues_Distro_4 4128 #LustrousBottleglass
pushlist Hues_Distro_4 4129 #LustrousStar
pushlist Hues_Distro_4 4130 #LustrousDream
pushlist Hues_Distro_4 4131 #LustrousEcru
pushlist Hues_Distro_4 4132 #LustrousChartreuse
pushlist Hues_Distro_4 4133 #LustrousCaramel
pushlist Hues_Distro_4 4134 #LustrousSteel
pushlist Hues_Distro_4 4135 #LustrousSlime
pushlist Hues_Distro_4 4136 #LustrousFlesh
pushlist Hues_Distro_4 4137 #LustrousOpal
pushlist Hues_Distro_4 4138 #LustrousAsh
pushlist Hues_Distro_4 4139 #LustrousJade
pushlist Hues_Distro_4 4140 #LustrousBone
pushlist Hues_Distro_4 4141 #LustrousDewdrop
pushlist Hues_Distro_4 2227 #PowderRuby
pushlist Hues_Distro_4 1495 #PowderCoral
pushlist Hues_Distro_4 1496 #PowderPeach
pushlist Hues_Distro_4 1382 #PowderLemon
pushlist Hues_Distro_4 1494 #PowderPistachio
pushlist Hues_Distro_4 2246 #PowderSeafoam
pushlist Hues_Distro_4 1381 #PowderSpring
pushlist Hues_Distro_4 2255 #PowderLapis
pushlist Hues_Distro_4 2877 #PowderCyan
pushlist Hues_Distro_4 1384 #PowderAzure
pushlist Hues_Distro_4 1462 #PowderOrchid
pushlist Hues_Distro_4 2173 #PowderIris
pushlist Hues_Distro_4 2903 #PowderCloud
pushlist Hues_Distro_4 2808 #PowderBlush
pushlist Hues_Distro_4 1952 #PowderBubblegum
pushlist Hues_Distro_4 1590 #PowderSnow
pushlist Hues_Distro_4 2380 #MetallicCherry
pushlist Hues_Distro_4 1989 #MetallicOrange
pushlist Hues_Distro_4 1990 #MetallicAmber
pushlist Hues_Distro_4 2653 #MetallicLemonLime
pushlist Hues_Distro_4 2398 #MetallicOlive
pushlist Hues_Distro_4 2828 #MetallicPickle
pushlist Hues_Distro_4 2845 #MetallicJuniper
pushlist Hues_Distro_4 2827 #MetallicMint
pushlist Hues_Distro_4 2826 #MetallicSky
pushlist Hues_Distro_4 2379 #MetallicSapphire
pushlist Hues_Distro_4 1484 #MetallicCerulean
pushlist Hues_Distro_4 2898 #MetallicEggplant
pushlist Hues_Distro_4 1489 #MetallicRaspberry
pushlist Hues_Distro_4 1995 #MetallicWine
pushlist Hues_Distro_4 2167 #MetallicPewter
pushlist Hues_Distro_4 2928 #MetallicChalk
pushlist Hues_Distro_4 1470 #MetallicUmber
pushlist Hues_Distro_4 2230 #DarkJam
pushlist Hues_Distro_4 1589 #DarkChocolate

# Sorting Cores
overhead "Sorting Cores..."

foreach hueVal in coreHues_Distro_3
    while findtype 'aspect core' 0x4F9D4339 hueVal as item
        lift item 1
        drop distro_3
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile
endfor

foreach hueVal in coreHues_Distro_4
    while findtype 'aspect core' 0x4F9D4339 hueVal as item
        lift item 1
        drop distro_4
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile
endfor
clearignore

# Sorting maps
overhead "Sorting Maps..." 44
clearignore

while findtype 'map' 0x4F9D4339 as item
    getlabel item label
    @setvar! moved 0

    foreach key in distro_3_keywords
        if key in label
            lift item 1
            drop distro_3 60 90 0
            getlabel 0x4F9D4339 delaycheck
            @setvar! moved 1
        endif
    endfor

    if moved = 0
        foreach key in distro_4_keywords
            if key in label
                lift item 1
                drop distro_4 60 90 0
                getlabel 0x4F9D4339 delaycheck
                @setvar! moved 1
            endif
        endfor
    endif

    if moved = 1
        @ignore item
    endif
endwhile
clearignore

#Sorting Skill Scrolls
overhead "Sorting Skill Scrolls..." 44
clearignore

 while findtype 'scroll of calling' 0x4F9D4339 as item
    getlabel item label
 if 'alchemy' in label
    lift item 1
    drop distro_4 15 50 0
    getlabel 0x4F9D4339 delaycheck
 elseif 'inscription' in label
    lift item 1
    drop distro_4 25 50 0
    getlabel 0x4F9D4339 delaycheck
 elseif 'chivalry' in label
    lift item 1
    drop distro_4 35 50 0
    getlabel 0x4F9D4339 delaycheck
 elseif 'tailoring' in label
    lift item 1
    drop distro_4 45 50 0
    getlabel 0x4F9D4339 delaycheck  
 elseif 'mastery' in label
    lift item 1
    drop distro_3 55 50 0
    getlabel 0x4F9D4339 delaycheck
 endif
 endwhile
clearignore

# Sorting Dyes, Cloth, Clothing
overhead "Sorting Dyes, Cloth, Clothing..."

foreach hueVal in Hues_Distro_2
    while findtype 'bottle' 0x4F9D4339 hueVal as item
        lift item 1
        drop distro_2 120 60 0
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile
    
    while findtype 'folded cloth' 0x4F9D4339 hueVal as item
        lift item 1
        drop distro_2
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile
    
    while findtype 'sandals' 0x4F9D4339 hueVal as item
        lift item 1
        drop distro_2
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile
    
    while findtype 'boots' 0x4F9D4339 hueVal as item
        lift item 1
        drop distro_2
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile
    
    while findtype 'shoes' 0x4F9D4339 hueVal as item
        lift item 1
        drop distro_2
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile
    
    while findtype 'thigh boots' 0x4F9D4339 hueVal as item
        lift item 1
        drop distro_2
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile
endfor

foreach hueVal in Hues_Distro_3
    while findtype 'bottle' 0x4F9D4339 hueVal as item
        lift item 1
        drop distro_3 120 60 0
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile
    
    while findtype 'folded cloth' 0x4F9D4339 hueVal as item
        lift item 1
        drop distro_3
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile
    
    while findtype 'sandals' 0x4F9D4339 hueVal as item
        lift item 1
        drop distro_3
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile
    
    while findtype 'boots' 0x4F9D4339 hueVal as item
        lift item 1
        drop distro_3
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile
    
    while findtype 'shoes' 0x4F9D4339 hueVal as item
        lift item 1
        drop distro_3
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile
    
    while findtype 'thigh boots' 0x4F9D4339 hueVal as item
        lift item 1
        drop distro_3
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile
endfor

foreach hueVal in Hues_Distro_4
    while findtype 'bottle' 0x4F9D4339 hueVal as item
        lift item 1
        drop distro_4 120 60 0
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile
    
    while findtype 'folded cloth' 0x4F9D4339 hueVal as item
        lift item 1
        drop distro_4
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile
    
    while findtype 'sandals' 0x4F9D4339 hueVal as item
        lift item 1
        drop distro_4
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile
    
    while findtype 'boots' 0x4F9D4339 hueVal as item
        lift item 1
        drop distro_4
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile
    
    while findtype 'shoes' 0x4F9D4339 hueVal as item
        lift item 1
        drop distro_4
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile
    
    while findtype 'thigh boots' 0x4F9D4339 hueVal as item
        lift item 1
        drop distro_4
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile
endfor
clearignore

    while findtype 'void orb' 0x4F9D4339 as item
        lift item 1
        drop distro_3
        getlabel 0x4F9D4339 delaycheck
        @ignore item
    endwhile

# Distro 1
overhead "Sorting Out Arcane Scrolls and Plant Chemicals" 44
# Add Item Ids to the findtype list
while findtype 29030|3827 0x4F9D4339 as item
    lift item 60000
    drop distro_1 -1 -1 0
    getlabel 0x4F9D4339 delaycheck
endwhile

# Distro 2
overhead "Sorting Distils, Phylacteries, MCDs, Low Tier Cloth, Clothing, and Dyes" 44
# Add Item Ids to the findtype list
while findtype 17087|576|17686|4026|5981|29036|3838 0x4F9D4339 as item
    lift item 1
    drop distro_2
     getlabel 0x4F9D4339 delaycheck
endwhile

# Distro 3
overhead "Sorting Basic Skill Scrolls, Skill Orbs, Low Tier Cores, Medium Tier Cloth, Clothing, and Dyes" 44
# Add Item Ids to the findtype list
while findtype 11858|5981|29025|15296|3839|3843|25359|3842 0x4F9D4339 as item
    lift item 1
    drop distro_3
    getlabel 0x4F9D4339 delaycheck
endwhile

# Distro 4
overhead "Sorting High Tier Skill Scrolls, Cores, Cloth, Clothing, and Dyes" 44
# Add Item Ids to the findtype list
while findtype 4025 0x4F9D4339 as item
    lift item 1
    drop distro_4
    getlabel 0x4F9D4339 delaycheck
endwhile

# Extra
overhead "Sorting Gems, Leather, and Food Stuffs" 44
# Add Item Ids to the findtype list
while findtype 3861|3885|3877|3862|3859|3865|3856|3873|3878|4225|39889|39891|39892|39896|39897|39898|39905|39909|39911|39912|39916|39917|39918|51098|22326|27611|7711|2496|2515|5641|2545|2422 0x4F9D4339 as item
    lift item 60000
    drop Extra
    getlabel 0x4F9D4339 delaycheck
endwhile

# Gold
overhead "Sorting Gold, Survival Gear, RMs, and Links" 44
# Add Item Ids to the findtype list
while findtype 37181|3821|24434|43206 0x4F9D4339 as item
    lift item 60000
    drop Gold
    getlabel 0x4F9D4339 delaycheck
endwhile
overhead "Item sorting complete!" 65
