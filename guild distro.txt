# Guild Distro Sorting Script
# Sorts items from backpack based upon item type into 5 distro chests
# script by TheZeroDivide
# last update:  5/2/2025 - removed inline comments, update void core hue value, update lift values
# todo:  boots/sandals/thighboots

# Set variables if they dont exist
if not varexist distro_1
    @setvar! distro_1 
endif
if not varexist distro_2
    @setvar! distro_2
endif
if not varexist distro_3
    @setvar! distro_3
endif
if not varexist distro_4
    @setvar! distro_4
endif
if not varexist distro_5
    @setvar! distro_5
endif

# Check if chests are full
overhead "Checking Chests"
getlabel distro_1 desc
    if "125 items" in desc
        overhead "First chest is full! Stopping Script!"
        stop
    endif
getlabel distro_2 desc
    if "125 items" in desc
        overhead "Second chest is full! Stopping Script!"
        stop
    endif
getlabel distro_3 desc
    if "125 items" in desc
        overhead "Third chest is full! Stopping Script!"
        stop
    endif
getlabel distro_4 desc
    if "125 items" in desc
        overhead "Fourth chest is full! Stopping Script!"
        stop
    endif
getlabel distro_5 desc
    if "125 items" in desc
        overhead "Fifth chest is full! Stopping Script!"
        stop
    endif

overhead "Starting item sort to distro chests" 65
clearignore

#Create lists to sort cores into
removelist coreHues_Distro_3
createlist coreHues_Distro_3
removelist coreHues_Distro_4
createlist coreHues_Distro_4


# Add Cores that should go in distro_3
# Air (2263), Blood (2087), Death (2155), Discipline (2490), Earth (2767), Fire (2635), Gadget (2669), Holy (2153), Lyric (2241), Madness (1060), Water (1788), War (2503)
pushlist coreHues_Distro_3 2263
pushlist coreHues_Distro_3 2087
pushlist coreHues_Distro_3 2155
pushlist coreHues_Distro_3 2490
pushlist coreHues_Distro_3 2767
pushlist coreHues_Distro_3 2635
pushlist coreHues_Distro_3 2669
pushlist coreHues_Distro_3 2153
pushlist coreHues_Distro_3 2241
pushlist coreHues_Distro_3 1060
pushlist coreHues_Distro_3 1788
pushlist coreHues_Distro_3 2503


# Add Cores that should go in distro_4
# Arcane (1560), Artisan (2096), Command (1782), Eldritch (2615), Fortune (2843), Frost (2234), Harvest (2086), Lightning (2650), Poison (2897), Shadow (1790), Void (2582)
pushlist coreHues_Distro_4 1560
pushlist coreHues_Distro_4 2096
pushlist coreHues_Distro_4 1782
pushlist coreHues_Distro_4 2615
pushlist coreHues_Distro_4 2843
pushlist coreHues_Distro_4 2234
pushlist coreHues_Distro_4 2086
pushlist coreHues_Distro_4 2650
pushlist coreHues_Distro_4 2897
pushlist coreHues_Distro_4 1790
pushlist coreHues_Distro_4 2582


# Set Map Keywords that should do in distro_3
removelist distro_3_keywords
createlist distro_3_keywords
pushlist distro_3_keywords "drawn"
pushlist distro_3_keywords "skinning"
pushlist distro_3_keywords "ore"
pushlist distro_3_keywords "lumber"

#Set Map Keywords that should go in distro_4
removelist distro_4_keywords
createlist distro_4_keywords
pushlist distro_4_keywords "plainly"
pushlist distro_4_keywords "expertly"
pushlist distro_4_keywords "dull"
pushlist distro_4_keywords "shadow"
pushlist distro_4_keywords "copper"
pushlist distro_4_keywords "bronze"
pushlist distro_4_keywords "gold"
pushlist distro_4_keywords "fish"

#Set Scrolls that should go in distro_3
removelist distro3_skillscroll_keywords
createlist distro3_skillscroll_keywords
pushlist distro3_skillscroll_keywords "tailoring"
pushlist distro3_skillscroll_keywords "inscription"
pushlist distro3_skillscroll_keywords "alchemy"
pushlist distro3_skillscroll_keywords "necromancy"

#Set Special Hues that should go to distro_4
removelist special_Hues_Distro_4
createlist special_Hues_Distro_4
pushlist special_Hues_Distro_4 "4124"
pushlist special_Hues_Distro_4 "4125"
pushlist special_Hues_Distro_4 "4126"
pushlist special_Hues_Distro_4 "4127"
pushlist special_Hues_Distro_4 "4128"
pushlist special_Hues_Distro_4 "4129"
pushlist special_Hues_Distro_4 "4130"
pushlist special_Hues_Distro_4 "4131"
pushlist special_Hues_Distro_4 "4132"
pushlist special_Hues_Distro_4 "4133"
pushlist special_Hues_Distro_4 "4134"
pushlist special_Hues_Distro_4 "4135"
pushlist special_Hues_Distro_4 "4136"
pushlist special_Hues_Distro_4 "4137"
pushlist special_Hues_Distro_4 "4138"
pushlist special_Hues_Distro_4 "4139"
pushlist special_Hues_Distro_4 "4140"
pushlist special_Hues_Distro_4 "4141"
pushlist special_Hues_Distro_4 "2227"
pushlist special_Hues_Distro_4 "1495"
pushlist special_Hues_Distro_4 "1496"
pushlist special_Hues_Distro_4 "1382"
pushlist special_Hues_Distro_4 "1494"
pushlist special_Hues_Distro_4 "2246"
pushlist special_Hues_Distro_4 "1381"
pushlist special_Hues_Distro_4 "2255"
pushlist special_Hues_Distro_4 "2877"
pushlist special_Hues_Distro_4 "1384"
pushlist special_Hues_Distro_4 "1462"
pushlist special_Hues_Distro_4 "2173"
pushlist special_Hues_Distro_4 "2903"
pushlist special_Hues_Distro_4 "2808"
pushlist special_Hues_Distro_4 "1952"
pushlist special_Hues_Distro_4 "1590"
pushlist special_Hues_Distro_4 "2380"
pushlist special_Hues_Distro_4 "1989"
pushlist special_Hues_Distro_4 "1990"
pushlist special_Hues_Distro_4 "2653"
pushlist special_Hues_Distro_4 "2398"
pushlist special_Hues_Distro_4 "2828"
pushlist special_Hues_Distro_4 "2845"
pushlist special_Hues_Distro_4 "2827"
pushlist special_Hues_Distro_4 "2826"
pushlist special_Hues_Distro_4 "2379"
pushlist special_Hues_Distro_4 "1484"
pushlist special_Hues_Distro_4 "2898"
pushlist special_Hues_Distro_4 "1489"
pushlist special_Hues_Distro_4 "1995"
pushlist special_Hues_Distro_4 "2167"
pushlist special_Hues_Distro_4 "2928"
pushlist special_Hues_Distro_4 "1470"
pushlist special_Hues_Distro_4 "1467"
pushlist special_Hues_Distro_4 "2807"
pushlist special_Hues_Distro_4 "1939"
pushlist special_Hues_Distro_4 "1465"
pushlist special_Hues_Distro_4 "2174"
pushlist special_Hues_Distro_4 "2804"
pushlist special_Hues_Distro_4 "2226"
pushlist special_Hues_Distro_4 "2801"
pushlist special_Hues_Distro_4 "1156"
pushlist special_Hues_Distro_4 "2230"
pushlist special_Hues_Distro_4 "1589"
pushlist special_Hues_Distro_4 "1779"
pushlist special_Hues_Distro_4 "1909"
pushlist special_Hues_Distro_4 "2091"
pushlist special_Hues_Distro_4 "2099"
pushlist special_Hues_Distro_4 "2085"
pushlist special_Hues_Distro_4 "2092"
pushlist special_Hues_Distro_4 "2089"
pushlist special_Hues_Distro_4 "2796"
pushlist special_Hues_Distro_4 "2338"
pushlist special_Hues_Distro_4 "2093"
pushlist special_Hues_Distro_4 "2659"
pushlist special_Hues_Distro_4 "2841"
pushlist special_Hues_Distro_4 "1182"
pushlist special_Hues_Distro_4 "1183"
pushlist special_Hues_Distro_4 "1500"



# Sorting Cores
overhead "Sorting Cores..."
foreach hueVal in coreHues_Distro_3
    while findtype 'aspect core' backpack hueVal as item
        lift item 1
        drop distro_3 -1 -1 0
        getlabel backpack delaycheck
        @ignore item
    endwhile
endfor

foreach hueVal in coreHues_Distro_4
    while findtype 'aspect core' backpack hueVal as item
        lift item 1
    drop distro_4 -1 -1 0
        getlabel backpack delaycheck
        @ignore item
    endwhile
endfor
clearignore

# Sorting maps
overhead "Sorting Maps..." 44
clearignore

while findtype 'map' backpack as item
    getlabel item label
    @setvar! moved 0

    foreach key in distro3_keywords
        if key in label
            lift item 1
            drop distro_3 60 90 0
            getlabel backpack delaycheck
            @setvar! moved 1
            break
        endif
    endfor

    if moved = 0
        foreach key in distro4_keywords
            if key in label
                lift item 1
                drop distro_4 60 90 0
                getlabel backpack delaycheck
                @setvar! moved 1
                break
            endif
        endfor
    endif

    if moved = 1
        @ignore item
    endif
endwhile
clearignore

#Sorting Skill Scrolls
overhead "Sorting Skill Scrolls..." 44
clearignore

while findtype 'scroll of calling' backpack as item
    getlabel item label
    @setvar! matched 0

    foreach skill in distro3_skillscroll_keywords
        if skill in label
            lift item 1
            drop Distro3 30 180 0
            pause 500
            @setvar! matched 1
            break
        endif
    endfor

    if matched = 0 and "scroll" in label
        lift item 1
        drop Distro4 30 180 0
        pause 500
    endif
    @ignore item
endwhile
clearignore

# Sorting Dyes (bottle_) into Distro chests
overhead "Sorting Dyes..." 44
clearignore

while findtype 'bottle_' backpack as dye
    getlabel dye label
    @setvar! moved 0

    # Check if special hue â†’ distro_4
    foreach hue in special_Hues_Distro_4
        if hue in label
            lift dye 1
            drop distro_4 60 90 0
            getlabel backpack delaycheck
            @setvar! moved 1
            break
        endif
    endfor

    # If not special, sort by type name
    if moved = 0
        if 'carpet' in label or 'runebook' in label
            lift dye 1
            drop distro_2 -1 -1 0
        elseif 'furniture' in label or 'mount' in label or 'chain' in label or 'backpack' in label or 'accessory' in label or 'headware' in label or 'hair' in label or 'facial hair' in label
            lift dye 1
            drop distro_3 -1 -1 0
        endif
        getlabel backpack delaycheck
    endif

    @ignore dye
endwhile

clearignore



# Distro 1
overhead "Sorting Items to First Distro Chest" 44
# Add Item Ids to the findtype list
while findtype 37181|3821|29030|3827|24434|43206 backpack as item
    lift item 60000
  drop distro_1 -1 -1 0
  getlabel backpack delaycheck
endwhile

# Distro 2
overhead "Sorting Items to Second Distro Chest" 44
# Add Item Ids to the findtype list
while findtype 22326|17087|576|17686|4026|5981|29036|3838|27611 backpack as item
    lift item 1
  drop distro_2 -1 -1 0
  getlabel backpack delaycheck
endwhile

# Distro 3
overhead "Sorting Items to Third Distro Chest" 44
# Add Item Ids to the findtype list
while findtype 11858|5981|29025|15296|3839|3843|25359|3842 backpack as item
    lift item 1
  drop distro_3 -1 -1 0
  getlabel backpack delaycheck
endwhile

# Distro 4
overhead "Sorting Items to Fourth Distro Chest" 44
# Add Item Ids to the findtype list
while findtype 4025 backpack as item
    lift item 1
  drop distro_4 -1 -1 0
  getlabel backpack delaycheck
endwhile

# Distro 5
overhead "Sorting Items to Fifth Distro Chest" 44
# Add Item Ids to the findtype list
while findtype 3861|3885|3877|3862|3859|3865|3856|3873|3878|4225|39889|39891|39892|39896|39897|39898|39905|39909|39911|39912|39916|39917|39918|51098|22326 backpack as item
    lift item 60000
    drop distro_5 -1 -1 0
    getlabel backpack delaycheck
endwhile

overhead "Item sorting complete!" 65
